# 概念



## 数据结构

| 类型   | 底层数据结构       | 简介                                                         | 特点                                                         |
| ------ | ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| String | 简单动态字符串     |                                                              | k-v都是字符串（v是数字的时候支持incr和decr）                 |
| List   | 双向链表、压缩列表 | 压缩列表，数组实现，将头结点和尾节点的偏移量放在了数组头部<br> | 有序列表，一个key对应多个val                                 |
| Hash   | 哈希表、压缩列表   |                                                              | hash结构，一个key对应的是一整个hash数据，有key、field1、val1... |
| Set    | 整数数组、压缩列表 |                                                              | 无序可重复集合                                               |
| ZSet   | 压缩列表和跳表     | 一种基于二分查找思想实现的树形结构。                         | 有序可重复集合，增加score作为顺序                            |

## 解决缓存雪崩和击穿

**解决雪崩**

由于在特定时间有大量的key过期导致大量请求打到数据库

1、有效时间增加随机值

2、动态分配key的有效时间

**解决击穿**

大量恶意请求，获取不到mysql数据，任然请求

1、布隆过滤器，数据是否存在在一个列表中能够记录下来（不存在则直接返回）

2、本地缓存，对于null也存储



## 集群

**主从复制**

目的就是从服务器备份主服务器的数据，防止数据丢失。

**哨兵模式**

哨兵可以进行主从的切换。防止单点故障。

**cluster模式**

1、将key分配到16832个槽里面，可以降低单个节点的压力

2、主从结构去中心化，出现故障，自动进行切换

3、数据复制，防止数据丢失

## Redis线程模型

[线程模型](https://www.iamshuaidi.com/2592.html)

1、内部多个Socket发起链接，进行链接的时候Socket产生AE_READABLE（可读时产生）和AE_WAITABLE（可写时产生）

2、发送到IO多路复用程序，IO多路复用程序管理Socket链接，将已经就绪的socket压入队列中排队等待处理

3、当排队等到要处理的时候，文件事件分派器判断当前socket是什么类型，将其调用对应的处理器去处理

+ 连接应答处理器：socket是要建立链接
+ 命令请求处理：socket是要进行读操作
+ 命令回复处理：socket是要进行写操作。

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20230221164157.png)



