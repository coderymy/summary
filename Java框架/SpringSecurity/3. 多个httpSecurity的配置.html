<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/606746 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="699"/>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000; margin-top: 14px;">3. 多个httpSecurity的配置</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">如果业务比较复杂，不同的登录需要不同的认证信息，可以写多个httpSecurity进行配置</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Configuration</span>
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">public</span> <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">class</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">MultiHttpSecurityConfig</span> </span>{
    <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Bean</span>
    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">PasswordEncoder <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">passwordEncoder</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>{
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> NoOpPasswordEncoder.getInstance();
    }

    <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Autowired</span>
    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">protected</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">configure</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(AuthenticationManagerBuilder auth)</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">throws</span>  Exception</span>{
        auth.inMemoryAuthentication()
                .withUser(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;admin&quot;</span>).password(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;123&quot;</span>).roles(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;&quot;</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">&quot;&quot;</span>)
                .and();
    }
    <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Configuration</span>
    <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Order</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">public</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">static</span>  <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">class</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">AdminSecurityConfig</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">extends</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">WebSecurityConfigurerAdapter</span></span>{
        <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Override</span>
        <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">protected</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">configure</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(HttpSecurity http)</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">throws</span> Exception </span>{
            XXXXXXXXXXXXXXX
        }
    }
    <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Configuration</span>
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">public</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">static</span> <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">class</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">OtherSecurityConfig</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">extends</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">WebSecurityConfigurerAdapter</span></span>{
        <span style="color: #9b9b9b; line-height: 160%; box-sizing: content-box;">@Override</span>
        <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">protected</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">void</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">configure</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(HttpSecurity http)</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">throws</span> Exception </span>{
            XXXXXXXXXXXXXXXXX
        }
    }
}

</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">需要注意的是，配置多个HttpSecurity时，外面的类不需要继承WebSecurityConfigurerAdapter，在其内部创建静态内部类继承即可。<br/>
<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">@Order()</code>注解表示该配置类的优先级，数字越小优先级越高。未加的优先级最小</p>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%203.%20%E5%A4%9A%E4%B8%AAhttpSecurity%E7%9A%84%E9%85%8D%E7%BD%AE%0A%E5%A6%82%E6%9E%9C%E4%B8%9A%E5%8A%A1%E6%AF%94%E8%BE%83%E5%A4%8D%E6%9D%82%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84%E7%99%BB%E5%BD%95%E9%9C%80%E8%A6%81%E4%B8%8D%E5%90%8C%E7%9A%84%E8%AE%A4%E8%AF%81%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%86%99%E5%A4%9A%E4%B8%AAhttpSecurity%E8%BF%9B%E8%A1%8C%E9%85%8D%E7%BD%AE%0A%0A%60%60%60java%0A%40Configuration%0Apublic%20class%20MultiHttpSecurityConfig%20%7B%0A%20%20%20%20%40Bean%0A%20%20%20%20PasswordEncoder%20passwordEncoder()%7B%0A%20%20%20%20%20%20%20%20return%20NoOpPasswordEncoder.getInstance()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Autowired%0A%20%20%20%20protected%20void%20configure(AuthenticationManagerBuilder%20auth)%20throws%20%20Exception%7B%0A%20%20%20%20%20%20%20%20auth.inMemoryAuthentication()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.withUser(%22admin%22).password(%22123%22).roles(%22%22%2C%22%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.and()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%40Configuration%0A%20%20%20%20%40Order(1)%0A%20%20%20%20public%20static%20%20class%20AdminSecurityConfig%20extends%20WebSecurityConfigurerAdapter%7B%0A%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20protected%20void%20configure(HttpSecurity%20http)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20XXXXXXXXXXXXXXX%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%40Configuration%0A%20%20%20%20public%20static%20class%20OtherSecurityConfig%20extends%20WebSecurityConfigurerAdapter%7B%0A%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20protected%20void%20configure(HttpSecurity%20http)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20XXXXXXXXXXXXXXXXX%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0A%60%60%60%0A%0A%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%98%AF%EF%BC%8C%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AAHttpSecurity%E6%97%B6%EF%BC%8C%E5%A4%96%E9%9D%A2%E7%9A%84%E7%B1%BB%E4%B8%8D%E9%9C%80%E8%A6%81%E7%BB%A7%E6%89%BFWebSecurityConfigurerAdapter%EF%BC%8C%E5%9C%A8%E5%85%B6%E5%86%85%E9%83%A8%E5%88%9B%E5%BB%BA%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB%E7%BB%A7%E6%89%BF%E5%8D%B3%E5%8F%AF%E3%80%82%0A%60%40Order()%60%E6%B3%A8%E8%A7%A3%E8%A1%A8%E7%A4%BA%E8%AF%A5%E9%85%8D%E7%BD%AE%E7%B1%BB%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%8C%E6%95%B0%E5%AD%97%E8%B6%8A%E5%B0%8F%E4%BC%98%E5%85%88%E7%BA%A7%E8%B6%8A%E9%AB%98%E3%80%82%E6%9C%AA%E5%8A%A0%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7%E6%9C%80%E5%B0%8F</center></span>
</div></body></html> 