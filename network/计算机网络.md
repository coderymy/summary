数据传输过程

1、（应用层）浏览器访问www.kaola.com，则浏览器先找地址薄协议 DNS（更精准的 HTTPDNS）找到 IP 地址106.114.138.24。

2、（应用层）浏览器打包请求（请求信息，ip 访问，头信息等）使用 HTTP 协议，如果是需要加密传输则使用 HTTPS 协议

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20250325172716.png)

3、（传输层）浏览器将包扔给传输层，传输层传输有两个协议，UDP 为无链接协议不保证一定送达，TCP 为面向连接协议如果不送达会持续重试。传输的时候将 HTTP的包，增加了浏览器的端口号

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20250325172728.png)

4、（网络层）传输层将包丢给网络层，网络层增加source IP 地址和target IP 地址

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20250325174956.png)

5、（链路层）想去国外需要通过海关，网络想访问别的局域网就需要通过网关（路由器），想找到网关就需要 ARP 协议（本地局域网的通信协议）ARP 协议会将包增加上 MAC 地址（局域网内通过 MAC 地址访问，局域网外通过 IP 地址访问）。网关的 IP 地址在操作系统初始化的时候通过 DHCP 协议赋予 `192.168.1.1`

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20250325175348.png)

6、（物理层-链路层-网络层）网关收到包后，会检查路由表来找到目标 IP 在哪。路由器有点像玄奘西行路过的一个个国家的一个个城关。每个城关都连着两个国家，每个国 家相当于一个局域网。一旦跨越城关，就需要拿出 IP 头来，里面写着贫僧来自东土大唐（就是源 IP 地址），欲往 西天拜佛求经（指的是目标 IP 地址）。路过宝地，借宿一晚，明日启行，请问接下来该怎 么走啊？ 然后所有的路由器就开始查找路由表告诉他怎么走。城关往往是知道这些“知识”的，因为城关和临近的城关也会经常沟通。到哪里应该怎么 走，这种沟通的协议称为路由协议，常用的有**OSPF**和**BGP**

7、（网络层）最后一个城关知道这个网络包要去的地方。于是，对着这个国家吼一声，谁是目标 IP 啊？ 目标服务器就会回复一个 MAC 地址。网络包过关后，通过这个 MAC 地址就能找到目标服务器。目标服务器发现 MAC 地址对上了，取下 MAC 头来，发送给操作系统的网络层。发现 IP 也对上了，就取下 IP 头。IP 头里会写上一层封装的是 TCP 协议，然后将其交给传输层， 即TCP 层。最后找到端口对应的应用。

![](https://coderymy-image.oss-cn-beijing.aliyuncs.com/picgo/20250325183244.png)

